@import '../../../../styles/design-tokens.scss';

.advanced-data-table {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  background: var(--color-background);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border-light);
  overflow: hidden;
}

// Table Controls Section
.table-controls {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-md) var(--spacing-lg);
  background: var(--color-background-subtle);
  border-bottom: 1px solid var(--color-border-light);
  gap: var(--spacing-md);

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: stretch;
    gap: var(--spacing-sm);
  }
}

.table-controls__filters {
  flex: 1;

  .filter-summary {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);

    .filter-icon {
      width: 16px;
      height: 16px;
      font-size: 16px;
      color: var(--color-primary-500);
    }

    .clear-filters-btn {
      font-size: var(--font-size-xs);
      padding: 4px var(--spacing-xs);
      min-width: auto;

      mat-icon {
        width: 14px;
        height: 14px;
        font-size: 14px;
        margin-right: 4px;
      }
    }
  }
}

.table-controls__actions {
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);

  .export-btn {
    font-size: var(--font-size-sm);
    padding: var(--spacing-xs) var(--spacing-sm);

    mat-icon {
      width: 16px;
      height: 16px;
      font-size: 16px;
      margin-right: var(--spacing-xs);
    }
  }

  .refresh-btn {
    color: var(--color-text-secondary);

    &:hover {
      color: var(--color-text-primary);
    }
  }
}

// Column Filters Section
.column-filters {
  padding: var(--spacing-sm) var(--spacing-lg);
  background: var(--color-background);
  border-bottom: 1px solid var(--color-border-light);
}

.column-filters__grid {
  display: grid;
  gap: var(--spacing-sm);
  align-items: center;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));

  @media (max-width: 768px) {
    grid-template-columns: 1fr;
  }
}

.filter-cell {
  min-height: 56px;
  display: flex;
  align-items: center;

  &--empty {
    min-height: 56px;
  }

  .filter-field {
    width: 100%;

    .mat-mdc-form-field-subscript-wrapper {
      display: none;
    }

    .mat-mdc-text-field-wrapper {
      min-height: 40px;
    }

    .clear-filter-btn {
      color: var(--color-text-secondary);

      &:hover {
        color: var(--color-text-primary);
      }
    }
  }
}

// Table Container
.table-container {
  position: relative;
  flex: 1;
  min-height: 200px;

  &--loading {
    pointer-events: none;
  }
}

.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.8);
  backdrop-filter: blur(2px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
  z-index: 10;

  .loading-text {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    margin: 0;
  }
}

// Data Table Styling
.data-table {
  width: 100%;
  background: var(--color-background);

  &--dense {
    .mat-mdc-row,
    .mat-mdc-header-row {
      min-height: 40px;
    }

    .mat-mdc-cell,
    .mat-mdc-header-cell {
      padding: var(--spacing-xs) var(--spacing-sm);
    }
  }

  &--sticky-header {
    .mat-mdc-header-row {
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--color-background-subtle);
    }
  }

  .mat-mdc-header-cell {
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    background: var(--color-background-subtle);
    border-bottom: 2px solid var(--color-border);
    padding: var(--spacing-sm) var(--spacing-md);
  }

  .mat-mdc-cell {
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--color-border-light);
  }

  .mat-mdc-row {
    &:hover:not(.data-row--selected) {
      background: var(--color-background-hover);
    }

    &.data-row--selected {
      background: var(--color-primary-50);
    }
  }
}

// Column Specific Styling
.selection-cell {
  width: 48px;
  padding: var(--spacing-sm) var(--spacing-md) var(--spacing-sm) var(--spacing-lg) !important;
  
  .mat-mdc-checkbox {
    margin: 0;
  }
}

.actions-cell {
  width: 120px;
  padding: var(--spacing-xs) var(--spacing-md) !important;

  .action-buttons {
    display: flex;
    gap: var(--spacing-xs);
    justify-content: flex-end;

    .action-btn {
      width: 32px;
      height: 32px;
      line-height: 32px;

      mat-icon {
        width: 18px;
        height: 18px;
        font-size: 18px;
      }
    }
  }
}

.text-left { text-align: left; }
.text-center { text-align: center; }
.text-right { text-align: right; }

// Cell Type Styling
.text-cell {
  color: var(--color-text-primary);
}

.number-cell {
  font-family: var(--font-family-mono);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-primary);
}

.date-cell {
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
}

// Status chip styling
.mat-mdc-chip-set {
  margin: 0;

  .mat-mdc-chip {
    height: 24px;
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    border-radius: var(--radius-full);

    // Status-specific colors
    &.bg-green-100 { 
      background: var(--color-success-100); 
      color: var(--color-success-700); 
    }
    &.bg-yellow-100 { 
      background: var(--color-warning-100); 
      color: var(--color-warning-700); 
    }
    &.bg-red-100 { 
      background: var(--color-error-100); 
      color: var(--color-error-700); 
    }
    &.bg-gray-100 { 
      background: var(--color-neutral-100); 
      color: var(--color-neutral-700); 
    }
    &.bg-blue-100 { 
      background: var(--color-info-100); 
      color: var(--color-info-700); 
    }
  }
}

// Empty State
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-xl);
  text-align: center;
  min-height: 300px;

  .empty-icon {
    width: 64px;
    height: 64px;
    font-size: 64px;
    color: var(--color-text-disabled);
    margin-bottom: var(--spacing-md);
  }

  .empty-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-sm) 0;
  }

  .empty-subtitle {
    color: var(--color-text-secondary);
    margin: 0 0 var(--spacing-lg) 0;
  }

  .empty-action {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);

    mat-icon {
      width: 18px;
      height: 18px;
      font-size: 18px;
    }
  }
}

// Pagination
.table-paginator {
  border-top: 1px solid var(--color-border-light);
  background: var(--color-background-subtle);
}

// Selection Summary
.selection-summary {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-sm) var(--spacing-lg);
  background: var(--color-primary-50);
  border-top: 1px solid var(--color-primary-200);

  .selection-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    color: var(--color-primary-700);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);

    mat-icon {
      width: 18px;
      height: 18px;
      font-size: 18px;
    }
  }

  .selection-actions {
    display: flex;
    gap: var(--spacing-sm);
  }
}

// Responsive Design
@media (max-width: 768px) {
  .advanced-data-table {
    border-radius: 0;
    border-left: none;
    border-right: none;
  }

  .table-container {
    overflow-x: auto;
  }

  .data-table {
    min-width: 600px;
  }

  .hide-on-mobile {
    display: none;
  }

  .column-filters__grid {
    grid-template-columns: 1fr;
  }
}

// Print Styles
@media print {
  .table-controls,
  .column-filters,
  .table-paginator,
  .selection-summary {
    display: none !important;
  }

  .data-table {
    border: 1px solid var(--color-border);

    .mat-mdc-header-cell,
    .mat-mdc-cell {
      border: 1px solid var(--color-border-light);
      padding: 4px 8px;
      font-size: 12px;
    }
  }

  .actions-cell {
    display: none !important;
  }
}

// Accessibility Improvements
.data-table {
  .mat-mdc-row:focus {
    outline: 2px solid var(--color-primary-500);
    outline-offset: -2px;
  }

  .mat-mdc-header-cell[aria-sort] {
    cursor: pointer;

    &:hover {
      background: var(--color-background-hover);
    }
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .data-table {
    .mat-mdc-header-cell {
      border-bottom-width: 3px;
    }

    .mat-mdc-row:hover {
      outline: 2px solid var(--color-text-primary);
    }
  }
}

// Additional utility classes for compatibility
.flex {
  display: flex;
}

.items-center {
  align-items: center;
}

.space-x-3 > * + * {
  margin-left: var(--spacing-sm);
}

.w-10 {
  width: 40px;
}

.h-10 {
  height: 40px;
}

.bg-primary {
  background-color: var(--color-primary-500);
}

.text-white {
  color: white;
}

.rounded-full {
  border-radius: 50%;
}

.justify-center {
  justify-content: center;
}

.font-medium {
  font-weight: var(--font-weight-medium);
}

.text-gray-900 {
  color: var(--color-text-primary);
}

.text-gray-500 {
  color: var(--color-text-secondary);
}

.text-xs {
  font-size: var(--font-size-xs);
}

.font-mono {
  font-family: var(--font-family-mono);
}
